please note: swagger docs folder and files are generated inside the cmd folder
Auto-generated by running go install github.com/swaggo/swag/cmd/swag@latest command, then `swag init` in the cmd directory.

1. Explanation of main.go file:

This code is a basic setup for a Golang application that includes the initialization of a database connection, configuration loading, repository creation, and setting up the router for handling HTTP requests.
The line calls the LoadConfig() function from the config package to load the application configuration. defining and implementing this function based on specific requirements.
setting up a connection to a PostgreSQL database using the specified Data Source Name (dsn). Adjust the dsn values according to database configuration. If the connection fails, the application will log an error and exit.
then creating an instance of the UserRepository by calling the NewUserRepository function from the repositories package. The repository is responsible for interacting with the database and performing CRUD operations related to the user entity.
then sets the router by calling the SetupRouter function from the routes package. The router handles HTTP requests and maps them to the appropriate controller methods.

2. internal/config/config.go:

The code defines a configuration package that includes a Config struct and a LoadConfig function.The Config struct represents the application configuration,The LoadConfig function is responsible for loading the application configuration.The LoadConfig function returns a pointer to the Config struct, allowing other parts of the application to access the configuration properties.

3. controllers/auth_controller.go:

The code represents the controller package, which contains the implementation of the authentication controller with the Register and Login methods.The AuthController struct represents the authentication controller. It has a single field UserRepository of type repositories.UserRepository, which is responsible for interacting with the user data in the database.The NewAuthController function creates a new instance of the AuthController and initializes it with the provided userRepo. This function acts as a constructor for the controller, allowing you to inject the necessary dependencies.The Register method handles the user registration API. It first parses the request payload into the RegisterRequest struct. If the payload is invalid, it returns a 400 Bad Request response.

Next, it creates a new User instance from the request data and calls the CreateUser method on the UserRepository to store the user in the database. If there is an error during the creation process, it returns a 500 Internal Server Error response.

If the user is created successfully, it returns a 200 OK response with a success message.The Login method handles the user login API. It parses the request payload into the LoginRequest struct and checks if the payload is valid. If it's not valid, it returns a 400 Bad Request response.

Next, it retrieves the user from the database based on the provided email. If the user is not found, it returns a 401 Unauthorized response.

Then, it checks if the provided password matches the user's password. If they don't match, it returns a 401 Unauthorized response.

If the credentials are valid, it generates a JWT token for the user's ID using the GenerateJWTToken function from the utils package. If there is an error during the token generation, it returns a 500 Internal Server Error response.

Finally, it returns a 200 OK response with the generated token and the user information.

4. controllers/user_controller.go:

The code represents the UserController package, which contains the implementation of the user controller with the GetProfile and UpdateProfile methods.The UserController struct represents the user controller. It has a single field UserRepository of type repositories.UserRepository, which is responsible for interacting with the user data in the database.The NewUserController function creates a new instance of the UserController and initializes it with the provided userRepo. This function acts as a constructor for the controller, allowing to inject the necessary dependencies.The GetProfile method handles the user profile retrieval API. It retrieves the user ID from the context using c.MustGet("userID"). If there is an error or the user ID is not available in the context, it returns a 500 Internal Server Error response.

Next, it calls the GetUserByID method on the UserRepository to retrieve the user from the database based on the ID. If there is an error during the retrieval process, it returns a 500 Internal Server Error response.

Finally, it returns a 200 OK response with the user information.The UpdateProfile method handles the user profile update API. It retrieves the user ID from the context using c.MustGet("userID"). If there is an error or the user ID is not available in the context, it returns a 500 Internal Server Error response.

Next, it parses the request payload into the UpdateProfileRequest struct. If the payload is invalid, it returns a 400 Bad Request response.

After that, it performs the required logic to convert the signed string to a public address and update it in the database. The specific logic for this conversion is not provided in the code and needs to be implemented separately.

Finally, it calls the UpdateUserProfile method on the UserRepository to update the user's profile. If there is an error during the update process, it returns a 500 Internal Server Error response. Otherwise, it returns a 200 OK response with a success message.

5. middleware/auth_middleware.go:

The code represents a middleware package with the implementation of the AuthMiddleware function, which serves as a middleware for authenticating JWT tokens. 
The AuthMiddleware function returns a gin.HandlerFunc, which is a middleware function that can be used in Gin framework. The middleware function is responsible for authenticating JWT tokens.The code checks if the Authorization header is present in the request. If it is missing, it returns a 401 Unauthorized response with an error message. The c.Abort() call stops the execution of subsequent handlers.The code splits the Authorization header value into two parts: the Bearer keyword and the token itself. It checks if the header has the correct format, i.e., two parts with the first part being "Bearer". If the format is invalid, it returns a 401 Unauthorized response with an error message.
The code calls the utils.ValidateJWTToken function to validate the JWT token and retrieve the user ID encoded in it. If the token is invalid, it returns a 401 Unauthorized response with an error message.The code sets the user ID in the context using c.Set("userID", userID). This allows other handlers or middleware to access the user ID from the context.

6. models/models.go

The code represents the models package, which defines the data structures used in the application.

7. repositories/repository.go:

The code represents the repositories package, which provides a data access layer for interacting with the database. The UserRepository struct represents the user repository and contains a reference to the gorm.DB object, which is used to perform database operations.The NewUserRepository function creates a new instance of the UserRepository with the provided gorm.DB object and returns a pointer to it.The CreateUser function is responsible for creating a new user in the database. It takes a pointer to a User object as a parameter and uses the gorm.DB object to create the user record. It returns an error if any error occurs during the database operation.The GetUserByEmail function retrieves a user from the database based on the provided email. It uses the gorm.DB object to query the user record by email and returns the user object if found. If the user is not found, it returns an error.The GetUserByID function retrieves a user from the database based on the provided user ID. It uses the gorm.DB object to query the user record by ID and returns the user object if found. If the user is not found, it returns an error.The UpdateUserProfile function is responsible for updating the user's profile in the database. It uses the gorm.DB object to update the "address" field of the user record with the provided address, based on the user's ID. It returns an error if any error occurs during the database operation.

8. routes/routes.go:

The code represents the routes package, which is responsible for setting up the router and defining the routes for the application.The SetupRouter function takes a UserRepository object as a parameter and returns a pointer to a gin.Engine object. It initializes a new gin.Engine object with the default middleware.Instances of AuthController and UserController are created by passing the UserRepository object.The authRoutes group is created using r.Group("/auth"). It groups the routes related to user authentication. Two routes are defined: POST /auth/register and POST /auth/login, which are handled by the corresponding methods in the authController.The userRoutes group is created using r.Group("/user"). It groups the routes related to user operations. The middleware.AuthMiddleware() is applied to this group to ensure that these routes require authentication. Two routes are defined: GET /user/profile and PUT /user/profile, which are handled by the corresponding methods in the userController.Finally, the function returns the gin.Engine object, which contains all the defined routes and middleware.

This SetupRouter function sets up the router and defines the routes for the application

9. utils/jwt.go:

The code is part of the utils package and provides utility functions for working with JWT (JSON Web Tokens).
GenerateJWTToken(userID uint) (string, error):

This function generates a new JWT token for the given user ID.
It creates a new token with the jwt.NewWithClaims function, specifying the signing method as HS256 (HMAC with SHA-256) and setting the token claims.
The claims include the userID and an expiration time (exp) set to 24 hours from the current time.
The token is then signed with a secret key using token.SignedString to generate the final token string.
The function returns the generated token string and an error if any occurred.
ValidateJWTToken(tokenString string) (uint, error):

This function validates a JWT token and returns the user ID extracted from the token.
It parses the token string using jwt.Parse and provides a callback function to verify the signing method and obtain the secret key.
If the token is successfully parsed and verified, it checks the token's claims to retrieve the userID value.
The userID is returned as a uint if the token is valid and the claims can be accessed; otherwise, it returns an error.

10. db migration is done

